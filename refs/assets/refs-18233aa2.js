import{h as Y,c as M,a as b,d as K,o as P,j as Z,i as O,f as A,S as U,k as V,F as ee,g as te,t as w,b as ne}from"./index-046cc47c.js";var Q=(e,t)=>e instanceof t||e&&e.constructor===t,W=e=>typeof e=="function"&&!e.length?e():e,H=e=>Array.isArray(e)?e:[e],re=()=>{let e=[];const t=()=>e=[];return{push:(...n)=>e.push(...n),execute(n,r,s,l){e.forEach(i=>i(n,r,s,l)),t()},clear:t}},se=e=>e.slice(),le=(e,t)=>{const n=se(e);return t(n),n},oe=(e,t,n=0,...r)=>le(e,s=>s.splice(t,n,...r)),ce=(e,t,...n)=>{const r=e.indexOf(t);return oe(e,r,1,...n)},ue=(e,...t)=>{const n=[];for(let r=0;r<e.length;r++){const s=e[r],l=t.indexOf(s);l!==-1?t.splice(l,1):n.push(s)}return n},ie=(e,...t)=>t.length===1?e.filter(n=>Q(n,t[0])):e.filter(n=>n&&t.some(r=>Q(n,r)));let ae=B;const D=1,R=2,fe={owned:null,cleanups:null,context:null,owner:null};var h=null;let N=null,g=null,d=null,S=null,j=0;function pe(e,t){const n=g,r=h,s=e.length===0,l=s?fe:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},i=s?e:()=>e(()=>q(()=>T(l)));h=l,g=null;try{return I(i,!0)}finally{g=n,h=r}}function q(e){if(g===null)return e();const t=g;g=null;try{return e()}finally{g=t}}function he(e){return h===null||(h.cleanups===null?h.cleanups=[e]:h.cleanups.push(e)),e}function ge(){return h}function de(e,t){const n=h,r=g;h=e,g=null;try{return I(t,!0)}catch(s){G(s)}finally{h=n,g=r}}function me(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&I(()=>{for(let s=0;s<e.observers.length;s+=1){const l=e.observers[s],i=N&&N.running;i&&N.disposed.has(l),(i&&!l.tState||!i&&!l.state)&&(l.pure?d.push(l):S.push(l),l.observers&&J(l)),i||(l.state=D)}if(d.length>1e6)throw d=[],new Error},!1)),t}function ve(e){if(!e.fn)return;T(e);const t=h,n=g,r=j;g=h=e,be(e,e.value,r),g=n,h=t}function be(e,t,n){let r;try{r=e.fn(t)}catch(s){e.pure&&(e.state=D,e.owned&&e.owned.forEach(T),e.owned=null),G(s)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?me(e,r):e.value=r,e.updatedAt=n)}function z(e){const t=N;if(e.state===0||t)return;if(e.state===R||t)return F(e);if(e.suspense&&q(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<j);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===D||t)ve(e);else if(e.state===R||t){const s=d;d=null,I(()=>F(e,n[0]),!1),d=s}}function I(e,t){if(d)return e();let n=!1;t||(d=[]),S?n=!0:S=[],j++;try{const r=e();return we(n),r}catch(r){n||(S=null),d=null,G(r)}}function we(e){if(d&&(B(d),d=null),e)return;const t=S;S=null,t.length&&I(()=>ae(t),!1)}function B(e){for(let t=0;t<e.length;t++)z(e[t])}function F(e,t){const n=N;e.state=0;for(let r=0;r<e.sources.length;r+=1){const s=e.sources[r];s.sources&&(s.state===D||n?s!==t&&z(s):(s.state===R||n)&&F(s,t))}}function J(e){const t=N;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=R,r.pure?d.push(r):S.push(r),r.observers&&J(r))}}function T(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const l=s.pop(),i=n.observerSlots.pop();r<s.length&&(l.sourceSlots[i]=r,s[r]=l,n.observerSlots[r]=i)}}if(e.owned){for(t=0;t<e.owned.length;t++)T(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function $e(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function G(e){throw e=$e(e),e}function xe(e,...t){return t.length===0&&(t=[ge()]),pe(n=>(H(W(t)).forEach(r=>r&&de(r,he.bind(void 0,n))),e(n)),t[0])}const _e=(e,t)=>{const n=e.indexOf(t);e.splice(n,1)};function ye(e,...t){return M(()=>ie(H(e()),...t.length?t:[Element]))}const Ee=(e,t)=>{Y(()=>t()(e))};function Se(e,t){let n=[];const r=new Set,s=t.length>1?new Map:void 0,l=Z(),[i,_]=b([]);K(P(e,k=>{const{length:C}=n,f=H(k).slice();if(!C)return _(n=f);for(let p=0,u=0;p<C;){const o=n[p];if(f.includes(o))p++,u++;else if(r.has(o)){const c=n.indexOf(f[u]);c!==-1&&c<=p?u++:(f.splice(u,0,o),s?.get(o)?.(u),p++)}else L(f,o,p),p++}_(n=f)}));let $=[];const E=()=>{$.length&&(_(k=>ue(k,...$)),$=[])};function L(k,C,f){xe(p=>{let u,o;if(s){const[a,m]=b(f),x=t(C,a),y=W(x);if(!y)return p();s.set(y,m),u=x,o=y}else{const a=t(C),m=W(a);if(!m)return p();u=a,o=m}r.add(o),k.splice(f,0,o);let c=o;K(P(u,a=>{if(r.delete(c),s){const m=s.get(c);if(s.delete(c),a)m&&s.set(a,m);else{const x=i();for(f=x.indexOf(c);f<x.length;f++)s.get(x[f])?.(y=>--y)}}if(!a)return _e(n,c),$.push(c),queueMicrotask(E),p();r.add(a),_(m=>ce(m,c,a)),c=a},{defer:!0}))},l)}return i}const ke=w('<div class="absolute bg-black"></div>'),Ce=w("<p>Elements count: </p>"),Ne=w('<div class="wrapper-h flex-wrap"><button class="btn">+ 1</button><button class="btn">- 1</button><button class="btn">toggle 0</button><button class="btn">toggle 1</button><button class="btn">toggle 2 & 3</button><button class="btn">toggle wrapper</button><button class="btn">clear</button></div>'),Ae=w("<p>Hello</p>"),Ie=w('<div class="node">ID 1</div>'),Oe=w('<div class="node">ID 2</div>'),Re=w('<div class="node">ID 3</div>'),De=w('<div class="wrapper-h flex-wrap"></div>'),Te=w('<div class="node">ID 0</div>'),Le=w('<div class="node bg-yellow-600">.</div>'),Ue=e=>{const t=ne(()=>e.children),n=ye(t,HTMLElement),r=re();return e.getClear?.(r.execute),Se(n,(l,i)=>{const[_,$]=b(l);return console.log("REMOVED",i()),r.push(()=>$(void 0)),l.style.filter="grayscale(100%)",l.style.position="relative",l.appendChild((()=>{const E=ke.cloneNode(!0);return O(E,i),E})()),l.addEventListener("click",()=>$(void 0)),_})},We=()=>{const[e,t]=b(!1),[n,r]=b(!1),[s,l]=b(!0),[i,_]=b(!0),[$,E]=b(5),[L,k]=b([]),[C,f]=b(0);setInterval(()=>f(u=>++u),1e3);let p;return[(()=>{const u=Ce.cloneNode(!0);return u.firstChild,O(u,()=>L().length,null),u})(),(()=>{const u=Ne.cloneNode(!0),o=u.firstChild,c=o.nextSibling,a=c.nextSibling,m=a.nextSibling,x=m.nextSibling,y=x.nextSibling,X=y.nextSibling;return o.$$click=()=>E(v=>++v),c.$$click=()=>E(v=>--v),a.$$click=()=>t(v=>!v),m.$$click=()=>r(v=>!v),x.$$click=()=>l(v=>!v),y.$$click=()=>_(v=>!v),X.$$click=()=>p(),u})(),(()=>{const u=De.cloneNode(!0);return O(u,A(Ue,{getClear:o=>p=o,get children(){return A(U,{get when(){return i()},get children(){return[Ae.cloneNode(!0),"World",M(()=>M(()=>!!e())()&&Te.cloneNode(!0)),A(U,{get when(){return n()},get children(){return Ie.cloneNode(!0)}}),A(U,{get when(){return s()},get children(){return[(()=>{const o=Oe.cloneNode(!0);return V(Ee,o,()=>c=>console.log("Unmounted",c)),o})(),Re.cloneNode(!0)]}}),A(ee,{get each(){return Array.from({length:$()},(o,c)=>c)},children:o=>(()=>{const c=Le.cloneNode(!0),a=c.firstChild;return O(c,o+1,a),c})()})]}})}})),u})()]};te(["click"]);export{We as default};
